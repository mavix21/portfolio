---
import { DateTimeDisplay } from "@/components/DateTimeDisplay";
import BaseHead from "../components/BaseHead.astro";
import { getLangFromUrl } from "../i18n/utils";
import { Menu, X } from "lucide-react";

interface Props {
  title: string;
  description: string;
}

const { title, description } = Astro.props;

const lang = getLangFromUrl(Astro.url);
---

<!doctype html>
<html lang={lang}>
  <BaseHead title={title} description={description} />
  <body>
    <div
      class="flex h-svh flex-col overflow-hidden bg-muted p-0 text-foreground md:p-2"
    >
      {/* CSS-only mobile menu toggle */}
      <input type="checkbox" id="mobile-menu-toggle" class="peer hidden" />

      {/* Mobile Header */}
      <header
        class="group sticky top-0 z-20 border bg-background/95 p-4 backdrop-blur-sm md:hidden"
      >
        <div class="flex items-center justify-between">
          {/* Logo */}
          Logo
          <label
            for="mobile-menu-toggle"
            class="relative z-40 cursor-pointer p-2 text-muted-foreground transition-colors hover:text-foreground"
            aria-label="Toggle menu"
          >
            <Menu size={24} className="group-peer-checked:hidden" />
            <X size={24} className="hidden group-peer-checked:block" />
          </label>
        </div>
      </header>

      {/* Mobile Menu Overlay */}
      <div
        class="group mobile-menu-overlay backdrop-blur-0 invisible fixed inset-0 top-18 z-10 opacity-0 transition-all duration-300 ease-in-out peer-checked:visible peer-checked:bg-background/75 peer-checked:opacity-100 peer-checked:backdrop-blur-sm"
      >
        <div
          class="flex h-full -translate-y-full transform flex-col px-6 pt-20 transition-transform duration-300 ease-in-out group-peer-checked:translate-y-0"
        >
          <div class="flex-1 overflow-y-auto">
            <div
              class="translate-y-4 opacity-0 transition-all delay-100 duration-300 ease-in-out group-peer-checked:translate-y-0 group-peer-checked:opacity-100"
            >
              Navigation
            </div>
          </div>
          <div
            class="translate-y-4 pb-8 opacity-0 transition-all delay-200 duration-300 ease-in-out group-peer-checked:translate-y-0 group-peer-checked:opacity-100"
          >
            <div class="flex flex-col gap-4">Footer</div>
          </div>
        </div>
      </div>

      {/* Frame border */}
      <div
        class="flex flex-1 border border-t-0 bg-background p-4 md:rounded md:border-t"
      >
        {/* Left Sidebar */}
        <div
          class="sticky top-0 z-10 hidden h-full w-64 flex-col space-y-8 border-r pr-4 md:flex"
        >
          {/* Header Section */}
          <div class="flex-shrink-0">
            {/* Logo */}
            <!-- {Logo} -->
            Logo
            <DateTimeDisplay lang={lang} client:load />
          </div>

          {/* Separator */}
          <div class="h-px w-full bg-border"></div>

          {/* Main Navigation - Scrollable */}
          <div
            class="scrollbar-thin scrollbar-thumb-border scrollbar-track-transparent flex-1 overflow-y-auto"
          >
            <!-- <Navigation /> -->
          </div>

          {/* Separator */}
          <div class="h-px w-full bg-border"></div>

          {/* Footer Section */}
          <div class="flex flex-shrink-0 flex-col gap-4">
            <!-- <SocialLinks />
          <ThemeSwitcher />
          <LanguageSwitcher />
          <MusicWidget /> {/* Music player widget at the bottom */} -->
          </div>
        </div>

        {/* Main Content Area */}
        <div class="flex h-full flex-1 flex-col pl-4">
          {/* Main Content */}
          <div class="animate-fade-in-up flex-1 overflow-y-auto">
            <slot />
          </div>

          {/* Footer */}
          <footer class="border-t border-border pt-4">
            <div class="text-center text-xs text-muted-foreground">
              Â© 2024 All rights reserved
            </div>
          </footer>
        </div>
      </div>
    </div>
  </body>
</html>
